<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Spring Boot集成MyBatis开发Web项目 | 笨笨个人笔记</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="/css/main.css?v=1.0.4"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body style="background:#fbfbfb;"><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Spring Boot集成MyBatis开发Web项目</h1><a id="logo" href="/.">笨笨个人笔记</a><p class="description">ibenben.org</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Spring Boot集成MyBatis开发Web项目</h1><div class="post-meta">Jul 23, 2016<span> | </span><span class="category"><a href="/categories/Spring/">Spring</a><a href="/categories/Spring/Spring-Boot/">Spring Boot</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="post-content"><h2 id="1、Maven构建Spring-Boot"><a href="#1、Maven构建Spring-Boot" class="headerlink" title="1、Maven构建Spring Boot"></a>1、Maven构建Spring Boot</h2><p>创建Maven Web工程，引入spring-boot-starter-parent依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;</span><br><span class="line">    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line">    &lt;groupId&gt;xyz.ibenben&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;zhongdian&lt;/artifactId&gt;</span><br><span class="line">    &lt;packaging&gt;war&lt;/packaging&gt;</span><br><span class="line">    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</span><br><span class="line">    &lt;name&gt;zhongdian Maven Webapp&lt;/name&gt;</span><br><span class="line">    &lt;url&gt;http://maven.apache.org&lt;/url&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Inherit defaults from Spring Boot --&gt;</span><br><span class="line">    &lt;parent&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;1.4.0.BUILD-SNAPSHOT&lt;/version&gt;</span><br><span class="line">    &lt;/parent&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Add typical dependencies for a web application --&gt;</span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;!-- Package as an executable jar --&gt;</span><br><span class="line">    &lt;build&gt;</span><br><span class="line">        &lt;plugins&gt;</span><br><span class="line">            &lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line">        &lt;/plugins&gt;</span><br><span class="line">    &lt;/build&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Add Spring repositories --&gt;</span><br><span class="line">    &lt;!-- (you don&apos;t need this if you are using a .RELEASE version) --&gt;</span><br><span class="line">    &lt;repositories&gt;</span><br><span class="line">        &lt;repository&gt;</span><br><span class="line">            &lt;id&gt;spring-snapshots&lt;/id&gt;</span><br><span class="line">            &lt;url&gt;http://repo.spring.io/snapshot&lt;/url&gt;</span><br><span class="line">            &lt;snapshots&gt;</span><br><span class="line">                &lt;enabled&gt;true&lt;/enabled&gt;</span><br><span class="line">            &lt;/snapshots&gt;</span><br><span class="line">        &lt;/repository&gt;</span><br><span class="line">        &lt;repository&gt;</span><br><span class="line">            &lt;id&gt;spring-milestones&lt;/id&gt;</span><br><span class="line">            &lt;url&gt;http://repo.spring.io/milestone&lt;/url&gt;</span><br><span class="line">        &lt;/repository&gt;</span><br><span class="line">    &lt;/repositories&gt;</span><br><span class="line">    &lt;pluginRepositories&gt;</span><br><span class="line">        &lt;pluginRepository&gt;</span><br><span class="line">            &lt;id&gt;spring-snapshots&lt;/id&gt;</span><br><span class="line">            &lt;url&gt;http://repo.spring.io/snapshot&lt;/url&gt;</span><br><span class="line">        &lt;/pluginRepository&gt;</span><br><span class="line">        &lt;pluginRepository&gt;</span><br><span class="line">            &lt;id&gt;spring-milestones&lt;/id&gt;</span><br><span class="line">            &lt;url&gt;http://repo.spring.io/milestone&lt;/url&gt;</span><br><span class="line">        &lt;/pluginRepository&gt;</span><br><span class="line">    &lt;/pluginRepositories&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure></p>
<p>使用spring-boot-starter-parent来构建Spring Boot项目是一个很好的方法，但很多项目本身就是依赖其它的父模块的，再或者spring-boot-starter-parent默认提供的那么多配置和功能我们用不到。</p>
<p>我们也可以使用其它的依赖方式来引入Spring Boot。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencyManagement&gt;</span><br><span class="line">     &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;!-- Import dependency management from Spring Boot --&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.4.0.BUILD-SNAPSHOT&lt;/version&gt;</span><br><span class="line">            &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">            &lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure></p>
<p>这是Spring官网给的demo配置，有兴趣的可以直接跳过去查看：<a href="http://docs.spring.io/spring-boot/docs/1.4.0.RC1/reference/htmlsingle/#getting-started-maven-installation" target="_blank" rel="noopener">http://docs.spring.io/spring-boot/docs/1.4.0.RC1/reference/htmlsingle/#getting-started-maven-installation</a></p>
<h2 id="2、Spring-Boot项目的代码结构"><a href="#2、Spring-Boot项目的代码结构" class="headerlink" title="2、Spring Boot项目的代码结构"></a>2、Spring Boot项目的代码结构</h2><p>Spring Boot项目与一般的Java Web项目的代码结构没有太大的区别或要求，但为了减少配置的数量（无配置），Spring Boot也有一些比较好的建议。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">com</span><br><span class="line"> +- example</span><br><span class="line">     +- myproject</span><br><span class="line">         +- Application.java</span><br><span class="line">         |</span><br><span class="line">         +- domain</span><br><span class="line">         |   +- Customer.java</span><br><span class="line">         |   +- CustomerRepository.java</span><br><span class="line">         |</span><br><span class="line">         +- service</span><br><span class="line">         |   +- CustomerService.java</span><br><span class="line">         |</span><br><span class="line">         +- web</span><br><span class="line">             +- CustomerController.java</span><br></pre></td></tr></table></figure></p>
<h2 id="2-1-不要使用默认的包路径"><a href="#2-1-不要使用默认的包路径" class="headerlink" title="2.1 不要使用默认的包路径"></a>2.1 不要使用默认的包路径</h2><p>我们交由Spring管理的类，需要放入一个包下。如下图中的DefaultClass.java是不行的。因为Spring Boot对带注解的类进行扫描的时候，这些默认包路径下的类会出问题。</p>
<p>当然，基于代码规范的要求，一般的程序员都不会这样子构建自己的代码，这里说明是为了真的遇到这种情况出问题时，可以快速地解决问题。</p>
<p><img src="/img/article/20160722165817881.png" alt="这里写图片描述"></p>
<h2 id="2-2-Spring-Boot应用入口"><a href="#2-2-Spring-Boot应用入口" class="headerlink" title="2.2 Spring Boot应用入口"></a>2.2 Spring Boot应用入口</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">package com.example.myproject;</span><br><span class="line"></span><br><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.EnableAutoConfiguration;</span><br><span class="line">import org.springframework.context.annotation.ComponentScan;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">@EnableAutoConfiguration</span><br><span class="line">@ComponentScan</span><br><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>入口类Application带main方法，我们直接运行main方法就能启动Spring Boot项目了，这样极大程序地方便了我们调试程序和项目。</p>
<p>Application类说明自己是Spring Boot的入口类，那么需要加入@Configuration注解。</p>
<p>@EnableAutoConfiguration习惯放在主方法类Application上，当项目运行时，Spring容器去自动查找带特定注解的类，如：带@Entity、@Service等类。</p>
<p>@ComponentScan如果不带basePackage 属性的话，它会自动扫描以入口类所在的包为父节点下所有子包下的类。这也是Spring Boot会提议我们把Application类放于根包路径下。</p>
<p>如果我们的项目和Spring Boot建议的代码结构一样，Application类放在根包路径下。那么我们可以使用@SpringBootApplication来代替上面三个注解。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">package com.example.myproject;</span><br><span class="line"></span><br><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="3、Spring-Boot的Web项目实现"><a href="#3、Spring-Boot的Web项目实现" class="headerlink" title="3、Spring Boot的Web项目实现"></a>3、Spring Boot的Web项目实现</h2><h2 id="3-1-Application类支持Web应用"><a href="#3-1-Application类支持Web应用" class="headerlink" title="3.1 Application类支持Web应用"></a>3.1 Application类支持Web应用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@SpringBootApplication</span><br><span class="line">public class Application extends SpringBootServletInitializer &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) &#123;</span><br><span class="line">        return application.sources(Application.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        SpringApplication.run(Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>入口类Application继承SpringBootServletInitializer并重写configure方法。运行主方法后，会将我们的web项目打包成war，并默认启动一个端口为8080的tomcat容器来运行我们的Web项目。</p>
<h2 id="3-2-其它服务器软件支持"><a href="#3-2-其它服务器软件支持" class="headerlink" title="3.2 其它服务器软件支持"></a>3.2 其它服务器软件支持</h2><p>如果我们不想使用tomcat，而是其它的服务器软件，如Jetty。你需要移除tomcat的依赖，并加入Jetty的依赖。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">    &lt;exclusions&gt;</span><br><span class="line">        &lt;exclusion&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;</span><br><span class="line">        &lt;/exclusion&gt;</span><br><span class="line">    &lt;/exclusions&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="3-3-服务器端口更改"><a href="#3-3-服务器端口更改" class="headerlink" title="3.3 服务器端口更改"></a>3.3 服务器端口更改</h2><p>增加application.yml配置文件。</p>
<p><img src="/img/article/20160722203941077.png" alt="这里写图片描述"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Server settings  </span><br><span class="line">server:  </span><br><span class="line">    port: 80</span><br><span class="line">    address: 127.0.0.1</span><br></pre></td></tr></table></figure></p>
<p>这里需要注意，yml配置文件是的值属性前面必须有一个空格，如果没有空格，Spring的解析器会忽略此配置项。</p>
<h2 id="3-4-Controller"><a href="#3-4-Controller" class="headerlink" title="3.4 Controller"></a>3.4 Controller</h2><p>Spring支持Spring MVC的Controler的使用方式。<br> 请参考：<a href="http://blog.csdn.net/p_3er/article/category/2868979" target="_blank" rel="noopener">http://blog.csdn.net/p_3er/article/category/2868979</a></p>
<p>Spring Boot应用中@RestController的Controller带有默认基于Jackson2的对象转JSON功能。如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class MyController &#123;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;/thing&quot;)</span><br><span class="line">    public MyThing thing() &#123;</span><br><span class="line">            return new MyThing();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="3-5-配置编码及JSP支持"><a href="#3-5-配置编码及JSP支持" class="headerlink" title="3.5 配置编码及JSP支持"></a>3.5 配置编码及JSP支持</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># SPRING PROFILES  </span><br><span class="line">spring:         </span><br><span class="line">    # HTTP ENCODING  </span><br><span class="line">    http:  </span><br><span class="line">        encoding.charset: UTF-8  </span><br><span class="line">        encoding.enable: true  </span><br><span class="line">        encoding.force: true  </span><br><span class="line">    mvc:</span><br><span class="line">        view.prefix: /WEB-INF/jsp/</span><br><span class="line">        view.suffix: .jsp</span><br></pre></td></tr></table></figure>
<p>加入以上配置后，还需要引入用于编译jsp的jasper包依赖。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;</span><br><span class="line">    &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p>加入JSP支持配置后，下面a方法和b方法者是跳转到/WEB-INF/jsp/regiester.jsp页面。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">package xyz.letus.boot.controller;</span><br><span class="line"></span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line">@Controller</span><br><span class="line">@RequestMapping(&quot;/page&quot;)</span><br><span class="line">public class PageController &#123;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;/a&quot;)</span><br><span class="line">    public String b(Map&lt;String, Object&gt; model)&#123;</span><br><span class="line">        model.put(&quot;msg&quot;, &quot;张三&quot;);     </span><br><span class="line">        return &quot;regiester&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;/b&quot;)</span><br><span class="line">    public ModelAndView b(HttpServletRequest request)&#123;</span><br><span class="line">        ModelAndView view = new ModelAndView();</span><br><span class="line">        view.setViewName(&quot;regiester&quot;);</span><br><span class="line"></span><br><span class="line">        request.setAttribute(&quot;msg&quot;, &quot;Davie&quot;);</span><br><span class="line">        return view;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="3-6-Spring-Boot应用实现热部署"><a href="#3-6-Spring-Boot应用实现热部署" class="headerlink" title="3.6 Spring Boot应用实现热部署"></a>3.6 Spring Boot应用实现热部署</h2><p>在插件管理中加入springloaded依赖就可以。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Package as an executable jar --&gt;</span><br><span class="line">   &lt;build&gt;</span><br><span class="line">       &lt;plugins&gt;</span><br><span class="line">           &lt;plugin&gt;</span><br><span class="line">               &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">               &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">               &lt;dependencies&gt;</span><br><span class="line">               &lt;!-- spring热部署--&gt;</span><br><span class="line">               &lt;dependency&gt;</span><br><span class="line">                   &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">                   &lt;artifactId&gt;springloaded&lt;/artifactId&gt;</span><br><span class="line">               &lt;/dependency&gt;</span><br><span class="line">           &lt;/dependencies&gt;</span><br><span class="line">           &lt;/plugin&gt;</span><br><span class="line">       &lt;/plugins&gt;</span><br><span class="line">   &lt;/build&gt;</span><br></pre></td></tr></table></figure></p>
<p>当系统通过 mvn spring-boot:run启动或者 右键application debug 启动java文件时，系统会监视classes文件，当有classes文件被改动时，系统会重新加载类文件，不用重启启动服务。</p>
<p>注：使用application run(非debug模式下)，热部署功能会失效。</p>
<h2 id="4、Spring-Boot集成MyBatis"><a href="#4、Spring-Boot集成MyBatis" class="headerlink" title="4、Spring Boot集成MyBatis"></a>4、Spring Boot集成MyBatis</h2><h2 id="4-1-加入基础依赖"><a href="#4-1-加入基础依赖" class="headerlink" title="4.1 加入基础依赖"></a>4.1 加入基础依赖</h2><p>MyBatis:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mybatis&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;3.4.0&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p>mybatis-spring-boot-starter：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https://mvnrepository.com/artifact/org.mybatis.spring.boot/mybatis-spring-boot-starter --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.1.1&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p>MySQL:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="4-2-数据库配置"><a href="#4-2-数据库配置" class="headerlink" title="4.2 数据库配置"></a>4.2 数据库配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># SPRING PROFILES  </span><br><span class="line">spring:         </span><br><span class="line">    # DATASOURCE  </span><br><span class="line">    datasource:  </span><br><span class="line">        driverClass: com.mysql.jdbc.Driver  </span><br><span class="line">        url: jdbc:mysql://127.0.0.1:3306/hire?useUnicode=true&amp;characterEncoding=utf-8  </span><br><span class="line">        username: root  </span><br><span class="line">        password: test</span><br></pre></td></tr></table></figure>
<h2 id="4-3-引入通用Mapper"><a href="#4-3-引入通用Mapper" class="headerlink" title="4.3 引入通用Mapper"></a>4.3 引入通用Mapper</h2><ul>
<li>引入依赖</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;tk.mybatis&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mapper&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.3.7&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>配置通用Mapper</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">package xyz.ibenben.zhongdian.common.configure;</span><br><span class="line"></span><br><span class="line">import org.springframework.boot.autoconfigure.AutoConfigureAfter;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line">import tk.mybatis.spring.mapper.MapperScannerConfigurer;</span><br><span class="line"></span><br><span class="line">import java.util.Properties;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">public class MyBatisMapperScannerConfig &#123;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public MapperScannerConfigurer mapperScannerConfigurer() &#123;</span><br><span class="line">        MapperScannerConfigurer mapperScannerConfigurer = new MapperScannerConfigurer();</span><br><span class="line">        mapperScannerConfigurer.setSqlSessionFactoryBeanName(&quot;sqlSessionFactory&quot;);</span><br><span class="line">        mapperScannerConfigurer.setBasePackage(&quot;xyz.ibenben.zhongdian.*.dao&quot;);</span><br><span class="line">        Properties properties = new Properties();</span><br><span class="line">        properties.setProperty(&quot;mappers&quot;, &quot;xyz.ibenben.zhongdian.common.BaseDao&quot;);</span><br><span class="line">        properties.setProperty(&quot;notEmpty&quot;, &quot;false&quot;);</span><br><span class="line">        properties.setProperty(&quot;IDENTITY&quot;, &quot;MYSQL&quot;);</span><br><span class="line">        mapperScannerConfigurer.setProperties(properties);</span><br><span class="line">        return mapperScannerConfigurer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其实MyBatisMapperScannerConfig 是一个MyBatis扫描Mapper接口扫描。</p>
<p>MapperScannerConfigurer根据指定的创建接口或注解创建映射器。我们这里映射了xyz.ibenben.zhongdian.*.dao包下的接口。</p>
<p>使用MapperScannerConfigurer，没有必要去指定SqlSessionFactory或SqlSessionTemplate，因为MapperScannerConfigurer将会创建MapperFactoryBean，之后自动装配。但是，如果你使用了一个以上的DataSource(因此，也是多个的SqlSessionFactory),那么自动装配可能会失效。这种情况下，你可以使用sqlSessionFactory或sqlSessionTemplate属性来设置正确的工厂/模板。</p>
<p>注意的是网络上有些文章中在MapperScannerConfigurer之前还配置了 MyBatisConfig，因为MapperScannerConfigurer会创建MapperFactoryBean，所以我的项目中没有再配置MyBatisConfig。经使用没有出现任何问题。</p>
<h2 id="4-4-通用Mapper的使用（Dao层）"><a href="#4-4-通用Mapper的使用（Dao层）" class="headerlink" title="4.4 通用Mapper的使用（Dao层）"></a>4.4 通用Mapper的使用（Dao层）</h2><p><strong>BaseDao：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">package xyz.ibenben.zhongdian.common;</span><br><span class="line"></span><br><span class="line">import tk.mybatis.mapper.common.Mapper;</span><br><span class="line">import tk.mybatis.mapper.common.MySqlMapper;</span><br><span class="line"></span><br><span class="line">public interface BaseDao&lt;T&gt; extends Mapper&lt;T&gt;,MySqlMapper&lt;T&gt;&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>*Dao:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">package xyz.ibenben.zhongdian.system.dao;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line">import xyz.ibenben.zhongdian.common.BaseDao;</span><br><span class="line">import xyz.ibenben.zhongdian.system.entity.User;</span><br><span class="line"></span><br><span class="line">public interface UserDao extends BaseDao&lt;User&gt;&#123;</span><br><span class="line"></span><br><span class="line">    @Select(&quot;select * from user where state = #&#123;state&#125;&quot;)</span><br><span class="line">    public List&lt;User&gt; selectByState(Integer state);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>MyBatis的Dao与其它的ORM框架不一样的是，MyBatis的Dao其实就是Mapper，是一个接口，是通过MapperScannerConfigurer扫描后生成实现的，我们不需要再写Dao接口的实现。</p>
<h2 id="4-5-业务处理及事务（Service层）"><a href="#4-5-业务处理及事务（Service层）" class="headerlink" title="4.5 业务处理及事务（Service层）"></a>4.5 业务处理及事务（Service层）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">package xyz.ibenben.zhongdian.system.service;</span><br><span class="line"></span><br><span class="line">import xyz.ibenben.zhongdian.system.entity.User;</span><br><span class="line"></span><br><span class="line">public interface UserService &#123;</span><br><span class="line">    public void saveUser(User user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">package xyz.ibenben.zhongdian.system.service.impl;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.apache.ibatis.session.RowBounds;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Service;</span><br><span class="line">import org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line">import xyz.ibenben.zhongdian.system.dao.TaskDao;</span><br><span class="line">import xyz.ibenben.zhongdian.system.dao.UserDao;</span><br><span class="line">import xyz.ibenben.zhongdian.system.entity.Task;</span><br><span class="line">import xyz.ibenben.zhongdian.system.entity.User;</span><br><span class="line">import xyz.ibenben.zhongdian.system.service.UserService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@Service</span><br><span class="line">public class UserServiceImpl implements UserService&#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    private UserDao userDao;</span><br><span class="line">    @Autowired</span><br><span class="line">    private TaskDao taskDao;</span><br><span class="line"></span><br><span class="line">    @Transactional</span><br><span class="line">    public void saveUser(User user)&#123;</span><br><span class="line">        user = userDao.selectByPrimaryKey(1);</span><br><span class="line">        user.setUsername(&quot;5566&quot;);</span><br><span class="line">        userDao.updateByPrimaryKey(user);</span><br><span class="line">//      int i = 10/0;</span><br><span class="line">        Task task = new Task();</span><br><span class="line">        task.setName(&quot;task 100&quot;);</span><br><span class="line">        task.setDescript(&quot;task100 descriot&quot;);</span><br><span class="line">        task.setState(1);</span><br><span class="line">        taskDao.insert(task);</span><br><span class="line"></span><br><span class="line">        Task temp = new Task();</span><br><span class="line">        task.setState(1);</span><br><span class="line">        List&lt;Task&gt; list = taskDao.selectByRowBounds(temp, new RowBounds(2, 12));</span><br><span class="line">        System.out.println(list.size());</span><br><span class="line">        for(Task t : list)&#123;</span><br><span class="line">            System.out.println(t.getName());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; users = userDao.selectByState(1);</span><br><span class="line">        for(User u : users)&#123;</span><br><span class="line">            System.out.println(u.getUsername());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Spring Boot集成MyBatis后，实现事物管理的方法很简单，只需要在业务方法前面加上@Transactional注解就可以了。</p>
<p>上面方法中用了一个被除数为0的表达式来进行测试事务。</p>
<h2 id="5、完整源码下载"><a href="#5、完整源码下载" class="headerlink" title="5、完整源码下载"></a>5、完整源码下载</h2><p><a href="https://github.com/ibenben/spring-boot-mybatis-demo" target="_blank" rel="noopener">https://github.com/ibenben/spring-boot-mybatis-demo</a></p>
</div><div class="tags"><a href="/tags/mysql/">mysql</a><a href="/tags/spring/">spring</a><a href="/tags/boot/">boot</a><a href="/tags/mybatis/">mybatis</a><a href="/tags/通用Mapper/">通用Mapper</a></div><div class="post-nav"><a href="/2016/08/31/52382728/" class="pre">Spring Boot之基于注解的数据格式化</a><a href="/2016/04/11/51024667/" class="next">javaer to go之简单的ORM封装</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2013-2018 <a href="/." rel="nofollow">笨笨个人笔记.</a></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=1.0.4" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.4" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.4"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.4"></script><script type="text/javascript" src="/js/prism.js?v=1.0.4"></script></div></body></html>